function init(){initMap(),chart=createChart()}function initMap(){startPosition=points[0],stopPosition=points[points.length-1];var t={zoom:14,center:points[0],mapTypeId:google.maps.MapTypeId.ROADMAP};if(min_lat*min_lng*max_lat*max_lng!=0){var a=new google.maps.LatLng(min_lat,min_lng),e=new google.maps.LatLng(max_lat,max_lng);bound=new google.maps.LatLngBounds(a,e)}map=new google.maps.Map(document.getElementById("map_canvas"),t),bound&&map.fitBounds(bound),route=new google.maps.Polyline({path:points,strokeColor:"#ff0000",strokeOpacity:.7,strokeWeight:4}),route.setMap(map);var o=new google.maps.MarkerImage("/static/images/map/starfinish-01.png",null,null,null,new google.maps.Size(24,24)),n=new google.maps.MarkerImage("/static/images/map/starfinish-02.png",null,null,null,new google.maps.Size(24,24));startMarker=new google.maps.Marker({position:startPosition,map:map,icon:o,title:"开始",draggable:!1}),stopMarker=new google.maps.Marker({position:stopPosition,map:map,icon:n,title:"停止",draggable:!1})}function formatTime(t){var a=new Date(t);return a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()}function createChart(){return new Highcharts.Chart({chart:{zoomType:"x",renderTo:"chart"},title:{text:null},subtitle:{text:null},xAxis:{labels:{formatter:function(){}}},yAxis:[{title:{text:null,style:{color:"#007ac2"}},labels:{style:{color:"#007ac2"},formatter:function(){return this.value}},min:0},{labels:{style:{color:"#aaaaaa"},formatter:function(){return this.value}},title:{text:null,style:{color:"#aaaaaa"}},min:min_altitude,opposite:!0}],tooltip:{formatter:function(){var t=this.points[0],a=this.points[1];return"速度："+t.y+"公里/小时<br>海拔："+a.y+" 米<br>时间："+formatTime(timeData[this.x])+"<br>距离：≈"+distanceOfPoints[this.x]+" 公里"},shared:!0,crosshairs:!0},plotOptions:{series:{marker:{enabled:!1},point:{events:{mouseOver:function(){var t=points[this.x];curPosMarker?curPosMarker.setPosition(t):curPosMarker=new google.maps.Marker({position:t,map:map,icon:"/static/images/map/marker.png"})}}}},line:{lineWidth:2,states:{hover:{lineWidth:2}}},areaspline:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#aaaaaa"],[1,"rgba(255,255,255,0.3)"]]},lineWidth:1.5,marker:{enabled:!1,states:{hover:{enabled:!0,radius:5}}},shadow:!1,states:{hover:{lineWidth:1.5}}}},legend:{enabled:!1},series:[{name:"速度",color:"#007ac2",type:"line",shadow:!1,zIndex:1,data:speedData},{name:"海拔",color:"#aaaaaa",type:"areaspline",shadow:!1,data:altitudeData,yAxis:1,zIndex:0}]})}var map,bound,route,startMarker,stopMarker,curPosMarker,startPosition,stopPosition,chart;$(init),Highcharts.setOptions({lang:{exportButtonTitle:"导出",printButtonTitle:"打印",downloadPNG:"导出PNG",downloadJPEG:"导出JPEG",downloadPDF:"导出PDF",downloadSVG:"",resetZoom:"恢复",resetZoomTitle:"恢复"}});